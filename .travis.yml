language: python

python:
  - "3.6"

services:
  - xvfb

before_install:
  - sudo apt-get update -qq
  - sudo apt-get install -y scilab
  - sudo apt-get install -y r-base
  - export DISPLAY=:99.0

# command to install dependencies
install:
  - git clone https://github.com/FOSSEE/online_test.git fossee-online-test
  - cd fossee-online-test
# install depenedencies for fossee online test
  - pip install -r requirements/requirements-common.txt
  - pip install -r requirements/requirements-codeserver.txt
  - python manage.py makemigrations
  - python manage.py migrate auth
  - python manage.py migrate
# start fossee-online-test
  - invoke serve
  - cd ..
  - git clone https://github.com/FOSSEE/workshop_booking.git fossee-workshop
  - cd fossee-workshop
# install depenedencies for workshop
  - pip install -r requirements.txt
  - python manage.py makemigrations
  - python manage.py migrate auth
  - python manage.py migrate
# start fossee-workshop
  - python manage.py runserver 5500
  - cd ..
# install depenedencies for task runner
  - pip install -r requirements.txt

before_script:
  - python manage.py makemigrations
  - python manage.py migrate auth
  - python manage.py migrate
# start taskrunner
  - python manage.py runserver 6500

# command to run tests and coverage
script:
# run the tests
  - python manage.py test createcourse.tests.TestFetchDataTask

dist:
  xenial

addons:
  firefox: "46.0"
